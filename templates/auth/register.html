{% extends 'base_landing.html' %}
{% block title %}Inscription{% endblock %}

{% block content %}
<canvas id="brainCanvas" class="brain-background"></canvas>
<section class="auth-container">
    <canvas id="authBrainCanvas" class="auth-brain-canvas"></canvas>
    
    <div class="container">
        <div class="row justify-content-center align-items-center min-vh-100 py-5">
            <div>
                <div class="auth-card" style="width: 100%; max-width: 100%; margin: 0;">
                    <div class="auth-header bg-success">
                        <h4 class="mb-0"><i class="fas fa-user-plus me-2"></i>Créer un Compte</h4>
                    </div>
                    <div class="auth-body">
                        <form method="post" class="auth-form form-row-spacing" enctype="multipart/form-data">
                            {% csrf_token %}
                            
                            {% if messages %}
                                {% for message in messages %}
                                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show mb-4" role="alert">
                                        {{ message }}
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                    </div>
                                {% endfor %}
                            {% endif %}
                            
                            <!-- Section: Informations de base -->
                            <div class="section-header mb-4">
                                <h5 class="text-primary"><i class="fas fa-user me-2"></i>Informations de base</h5>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Nom d'utilisateur *</label>
                                        <input type="text" name="username" class="form-control" required autofocus
                                               placeholder="Choisissez un nom d'utilisateur">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Adresse Email *</label>
                                        <input type="email" name="email" class="form-control" required
                                               placeholder="votre@email.com">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Prénom</label>
                                        <input type="text" name="first_name" class="form-control"
                                               placeholder="Votre prénom">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Nom</label>
                                        <input type="text" name="last_name" class="form-control"
                                               placeholder="Votre nom">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Numéro de téléphone</label>
                                        <input type="tel" name="phone_number" class="form-control" 
                                               placeholder="+216 XX XXX XXX">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Photo de profil</label>
                                        <input type="file" name="photo" class="form-control" accept="image/*">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Mot de passe *</label>
                                        <input type="password" name="password" class="form-control" required
                                               placeholder="Créez un mot de passe sécurisé">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Confirmer le mot de passe *</label>
                                        <input type="password" name="password2" class="form-control" required
                                               placeholder="Confirmez votre mot de passe">
                                    </div>
                                </div>
                            </div>

                            <!-- Section: Informations personnelles -->
                            <div class="section-header mb-4 mt-4">
                                <h5 class="text-primary"><i class="fas fa-id-card me-2"></i>Informations personnelles</h5>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Âge</label>
                                        <input type="number" name="age" class="form-control" min="1" max="120"
                                               placeholder="Votre âge">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Sexe</label>
                                        <select name="sexe" class="form-select">
                                            <option value="">Sélectionnez...</option>
                                            <option value="M">Masculin</option>
                                            <option value="F">Féminin</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">État civil</label>
                                        <input type="text" name="etat_civil" class="form-control"
                                               placeholder="Votre état civil">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Profession</label>
                                        <input type="text" name="profession" class="form-control"
                                               placeholder="Votre profession">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Statut professionnel</label>
                                        <select name="status_professionnel" class="form-select">
                                            <option value="">Sélectionnez...</option>
                                            <option value="etudiant">Étudiant</option>
                                            <option value="travailleur">Travailleur</option>
                                            <option value="freelance">Freelance</option>
                                            <option value="chomeur">Chômeur</option>
                                            <option value="retraite">Retraité</option>
                                            <option value="autre">Autre</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
<!-- NOUVELLE SECTION : Adresse -->
                            <div class="section-header mb-4 mt-4">
                                <h5 class="text-primary"><i class="fas fa-home me-2"></i>Adresse</h5>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Rue et numéro</label>
                                        <input type="text" name="adresse_rue" class="form-control"
                                               placeholder="Ex: 123 Rue de la République">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Ville</label>
                                        <input type="text" name="adresse_ville" class="form-control"
                                               placeholder="Ex: Tunis">
                                    </div>
                                </div>
                            </div><div class="row">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Code postal</label>
                                        <input type="text" name="adresse_code_postal" class="form-control"
                                               placeholder="Ex: 1000">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Province/Région</label>
                                        <input type="text" name="adresse_province" class="form-control"
                                               placeholder="Ex: Tunis">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Pays</label> 
                                                <input type="text" name="adresse_pays" class="form-control"
                                               placeholder="Ex: Tunisie" value="Tunisie">
                                    </div>
                                </div>
                            </div>
                            <!-- Nouveaux champs pour centres d'intérêt et passions -->
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Centres d'intérêt</label>
                                        <input type="text" name="centres_interet" class="form-control"
                                               placeholder="Séparez par des virgules">
                                        <small class="text-muted">Ex: Lecture, Sport, Musique</small>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Passions</label>
                                        <input type="text" name="passions" class="form-control"
                                               placeholder="Séparez par des virgules">
                                        <small class="text-muted">Ex: Voyage, Photographie, Cuisine</small>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Langue</label>
                                <select name="langue" class="form-select">
                                    <option value="fr" selected>Français</option>
                                    <option value="en">English</option>
                                </select>
                            </div>

                            <!-- Section: Traits de personnalité -->
                            <div class="section-header mb-4 mt-4">
                                <h5 class="text-primary"><i class="fas fa-brain me-2"></i>Traits de personnalité</h5>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" name="casanier" id="casanier">
                                            <label class="form-check-label" for="casanier">Casanier</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" name="sociable" id="sociable">
                                            <label class="form-check-label" for="sociable">Sociable</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Section: Bien-être et habitudes -->
                            <div class="section-header mb-4 mt-4">
                                <h5 class="text-primary"><i class="fas fa-heartbeat me-2"></i>Bien-être et habitudes</h5>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Humeur générale</label>
                                        <select name="humeur_generale" class="form-select">
                                            <option value="neutre" selected>Neutre</option>
                                            <option value="heureux">Heureux</option>
                                            <option value="triste">Triste</option>
                                            <option value="anxieux">Anxieux</option>
                                            <option value="stresse">Stressé</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Niveau de stress (0-10)</label>
                                        <input type="range" name="niveau_stress" class="form-range" min="0" max="10" value="5">
                                        <div class="d-flex justify-content-between">
                                            <small>0</small>
                                            <small id="stressValue">5</small>
                                            <small>10</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Qualité de sommeil</label>
                                        <select name="qualite_sommeil" class="form-select">
                                            <option value="moyen" selected>Moyen</option>
                                            <option value="excellent">Excellent</option>
                                            <option value="bon">Bon</option>
                                            <option value="mauvais">Mauvais</option>
                                            <option value="tres_mauvais">Très Mauvais</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Heures de sommeil par nuit</label>
                                        <input type="number" name="heures_sommeil_par_nuit" class="form-control" 
                                               min="0" max="24" step="0.5" value="7.0">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Niveau d'activité physique</label>
                                        <select name="niveau_activite_physique" class="form-select">
                                            <option value="sedentaire" selected>Sédentaire</option>
                                            <option value="leger">Léger</option>
                                            <option value="modere">Modéré</option>
                                            <option value="intense">Intense</option>
                                            <option value="tres_intense">Très Intense</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Habitudes alimentaires</label>
                                        <select name="habitudes_alimentaires" class="form-select">
                                            <option value="equilibree" selected>Équilibrée</option>
                                            <option value="vegetarien">Végétarien</option>
                                            <option value="vegan">Vegan</option>
                                            <option value="sans_gluten">Sans Gluten</option>
                                            <option value="variable">Variable</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Section: Préférences d'écriture -->
                            <div class="section-header mb-4 mt-4">
                                <h5 class="text-primary"><i class="fas fa-pen me-2"></i>Préférences d'écriture</h5>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Fréquence d'écriture souhaitée</label>
                                        <select name="frequence_ecriture_souhaitee" class="form-select">
                                            <option value="variable" selected>Variable</option>
                                            <option value="matin">Matin</option>
                                            <option value="midi">Midi</option>
                                            <option value="soir">Soir</option>
                                            <option value="nuit">Nuit</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Moment préféré d'écriture</label>
                                        <select name="moment_prefere_ecriture" class="form-select">
                                            <option value="variable" selected>Variable</option>
                                            <option value="matin">Matin</option>
                                            <option value="midi">Midi</option>
                                            <option value="soir">Soir</option>
                                            <option value="nuit">Nuit</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Note about optional fields -->
                            <div class="alert alert-info mt-4">
                                <small>
                                    <i class="fas fa-info-circle me-1"></i>
                                    Tous les champs marqués d'un astérisque (*) sont obligatoires. 
                                    Les autres champs sont facultatifs et peuvent être complétés ultérieurement.
                                </small>
                            </div>

                            <button type="submit" class="btn auth-btn auth-btn-success w-100 mb-3 mt-4">
                                <i class="fas fa-user-plus me-2"></i>S'inscrire
                            </button>
                        </form>
                        
                        <div class="text-center mt-4">
                            <p class="mb-0 text-muted">
                                Déjà un compte ? 
                                <a href="{% url 'users:login' %}" class="auth-link">Se connecter</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    // Update stress value display when slider changes
    document.querySelector('input[name="niveau_stress"]').addEventListener('input', function() {
        document.getElementById('stressValue').textContent = this.value;
    });
</script>
{% endblock %}